{"ast":null,"code":"\"use strict\";\n\nfunction _classCallCheck(instance, Constructor) {\n  if (!(instance instanceof Constructor)) {\n    throw new TypeError(\"Cannot call a class as a function\");\n  }\n}\n\nfunction _defineProperties(target, props) {\n  for (var i = 0; i < props.length; i++) {\n    var descriptor = props[i];\n    descriptor.enumerable = descriptor.enumerable || false;\n    descriptor.configurable = true;\n    if (\"value\" in descriptor) descriptor.writable = true;\n    Object.defineProperty(target, descriptor.key, descriptor);\n  }\n}\n\nfunction _createClass(Constructor, protoProps, staticProps) {\n  if (protoProps) _defineProperties(Constructor.prototype, protoProps);\n  if (staticProps) _defineProperties(Constructor, staticProps);\n  return Constructor;\n}\n\nvar JsSIP_C = require('./Constants');\n\nvar Utils = require('./Utils');\n\nvar Grammar = require('./Grammar');\n/**\n * -param {String} [scheme]\n * -param {String} [user]\n * -param {String} host\n * -param {String} [port]\n * -param {Object} [parameters]\n * -param {Object} [headers]\n *\n */\n\n\nmodule.exports =\n/*#__PURE__*/\nfunction () {\n  _createClass(URI, null, [{\n    key: \"parse\",\n\n    /**\n      * Parse the given string and returns a JsSIP.URI instance or undefined if\n      * it is an invalid URI.\n      */\n    value: function parse(uri) {\n      uri = Grammar.parse(uri, 'SIP_URI');\n\n      if (uri !== -1) {\n        return uri;\n      } else {\n        return undefined;\n      }\n    }\n  }]);\n\n  function URI(scheme, user, host, port) {\n    var parameters = arguments.length > 4 && arguments[4] !== undefined ? arguments[4] : {};\n    var headers = arguments.length > 5 && arguments[5] !== undefined ? arguments[5] : {};\n\n    _classCallCheck(this, URI); // Checks.\n\n\n    if (!host) {\n      throw new TypeError('missing or invalid \"host\" parameter');\n    } // Initialize parameters.\n\n\n    this._parameters = {};\n    this._headers = {};\n    this._scheme = scheme || JsSIP_C.SIP;\n    this._user = user;\n    this._host = host;\n    this._port = port;\n\n    for (var param in parameters) {\n      if (Object.prototype.hasOwnProperty.call(parameters, param)) {\n        this.setParam(param, parameters[param]);\n      }\n    }\n\n    for (var header in headers) {\n      if (Object.prototype.hasOwnProperty.call(headers, header)) {\n        this.setHeader(header, headers[header]);\n      }\n    }\n  }\n\n  _createClass(URI, [{\n    key: \"setParam\",\n    value: function setParam(key, value) {\n      if (key) {\n        this._parameters[key.toLowerCase()] = typeof value === 'undefined' || value === null ? null : value.toString();\n      }\n    }\n  }, {\n    key: \"getParam\",\n    value: function getParam(key) {\n      if (key) {\n        return this._parameters[key.toLowerCase()];\n      }\n    }\n  }, {\n    key: \"hasParam\",\n    value: function hasParam(key) {\n      if (key) {\n        return this._parameters.hasOwnProperty(key.toLowerCase()) && true || false;\n      }\n    }\n  }, {\n    key: \"deleteParam\",\n    value: function deleteParam(parameter) {\n      parameter = parameter.toLowerCase();\n\n      if (this._parameters.hasOwnProperty(parameter)) {\n        var value = this._parameters[parameter];\n        delete this._parameters[parameter];\n        return value;\n      }\n    }\n  }, {\n    key: \"clearParams\",\n    value: function clearParams() {\n      this._parameters = {};\n    }\n  }, {\n    key: \"setHeader\",\n    value: function setHeader(name, value) {\n      this._headers[Utils.headerize(name)] = Array.isArray(value) ? value : [value];\n    }\n  }, {\n    key: \"getHeader\",\n    value: function getHeader(name) {\n      if (name) {\n        return this._headers[Utils.headerize(name)];\n      }\n    }\n  }, {\n    key: \"hasHeader\",\n    value: function hasHeader(name) {\n      if (name) {\n        return this._headers.hasOwnProperty(Utils.headerize(name)) && true || false;\n      }\n    }\n  }, {\n    key: \"deleteHeader\",\n    value: function deleteHeader(header) {\n      header = Utils.headerize(header);\n\n      if (this._headers.hasOwnProperty(header)) {\n        var value = this._headers[header];\n        delete this._headers[header];\n        return value;\n      }\n    }\n  }, {\n    key: \"clearHeaders\",\n    value: function clearHeaders() {\n      this._headers = {};\n    }\n  }, {\n    key: \"clone\",\n    value: function clone() {\n      return new URI(this._scheme, this._user, this._host, this._port, JSON.parse(JSON.stringify(this._parameters)), JSON.parse(JSON.stringify(this._headers)));\n    }\n  }, {\n    key: \"toString\",\n    value: function toString() {\n      var headers = [];\n      var uri = \"\".concat(this._scheme, \":\");\n\n      if (this._user) {\n        uri += \"\".concat(Utils.escapeUser(this._user), \"@\");\n      }\n\n      uri += this._host;\n\n      if (this._port || this._port === 0) {\n        uri += \":\".concat(this._port);\n      }\n\n      for (var parameter in this._parameters) {\n        if (Object.prototype.hasOwnProperty.call(this._parameters, parameter)) {\n          uri += \";\".concat(parameter);\n\n          if (this._parameters[parameter] !== null) {\n            uri += \"=\".concat(this._parameters[parameter]);\n          }\n        }\n      }\n\n      for (var header in this._headers) {\n        if (Object.prototype.hasOwnProperty.call(this._headers, header)) {\n          var _iteratorNormalCompletion = true;\n          var _didIteratorError = false;\n          var _iteratorError = undefined;\n\n          try {\n            for (var _iterator = this._headers[header][Symbol.iterator](), _step; !(_iteratorNormalCompletion = (_step = _iterator.next()).done); _iteratorNormalCompletion = true) {\n              var item = _step.value;\n              headers.push(\"\".concat(header, \"=\").concat(item));\n            }\n          } catch (err) {\n            _didIteratorError = true;\n            _iteratorError = err;\n          } finally {\n            try {\n              if (!_iteratorNormalCompletion && _iterator.return != null) {\n                _iterator.return();\n              }\n            } finally {\n              if (_didIteratorError) {\n                throw _iteratorError;\n              }\n            }\n          }\n        }\n      }\n\n      if (headers.length > 0) {\n        uri += \"?\".concat(headers.join('&'));\n      }\n\n      return uri;\n    }\n  }, {\n    key: \"toAor\",\n    value: function toAor(show_port) {\n      var aor = \"\".concat(this._scheme, \":\");\n\n      if (this._user) {\n        aor += \"\".concat(Utils.escapeUser(this._user), \"@\");\n      }\n\n      aor += this._host;\n\n      if (show_port && (this._port || this._port === 0)) {\n        aor += \":\".concat(this._port);\n      }\n\n      return aor;\n    }\n  }, {\n    key: \"scheme\",\n    get: function get() {\n      return this._scheme;\n    },\n    set: function set(value) {\n      this._scheme = value.toLowerCase();\n    }\n  }, {\n    key: \"user\",\n    get: function get() {\n      return this._user;\n    },\n    set: function set(value) {\n      this._user = value;\n    }\n  }, {\n    key: \"host\",\n    get: function get() {\n      return this._host;\n    },\n    set: function set(value) {\n      this._host = value.toLowerCase();\n    }\n  }, {\n    key: \"port\",\n    get: function get() {\n      return this._port;\n    },\n    set: function set(value) {\n      this._port = value === 0 ? value : parseInt(value, 10) || null;\n    }\n  }]);\n\n  return URI;\n}();","map":null,"metadata":{},"sourceType":"script"}