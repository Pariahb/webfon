{"ast":null,"code":"import _slicedToArray from \"/home/paria/sandbox/projects/webfon-V2/webfonv2/node_modules/@babel/runtime/helpers/esm/slicedToArray\";\nvar _jsxFileName = \"/home/paria/sandbox/projects/webfon-V2/webfonv2/src/components/contact-item/index.js\";\nimport React, { useEffect, useState } from \"react\";\nimport avatarImage from \"../../images/avatar.jpg\";\nimport \"./style.css\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport RosterStatusDetector from \"../roster-status-detector\";\nimport $ from \"jquery\";\n\nconst ContactItem = props => {\n  const dispatch = useDispatch();\n  const connection = useSelector(state => state.connection);\n  const $iq = useSelector(state => state.$iq);\n  const showMainPage = useSelector(state => state.showMainPage);\n\n  const _useState = useState(''),\n        _useState2 = _slicedToArray(_useState, 2),\n        lastActivity = _useState2[0],\n        setLastActivity = _useState2[1];\n\n  const handleRosterClick = contact => {\n    console.log(contact);\n    dispatch({\n      contact,\n      type: \"SET_SELECTED_ROSTER\"\n    });\n  };\n\n  const getLastActivity = () => {\n    let iq = $iq({\n      type: \"get\",\n      from: connection.jid,\n      to: props.item.jid,\n      id: \"last1\"\n    }).c(\"query\", {\n      xmlns: \"jabber:iq:last\"\n    });\n    connection.sendIQ(iq);\n  };\n\n  useEffect(() => {\n    getLastActivity();\n  }, [showMainPage]);\n\n  const onLastActivity = iq => {\n    let from = $(iq).attr(\"from\"); // the jabber_id of the contact\\+\n\n    let contact = document.querySelectorAll('.item');\n    console.log(\"from\", from);\n    $(iq).each(() => {\n      let lastActivity = {\n        from: from,\n        time: seconds\n      };\n      console.log(\"lastActivity\", $(iq).find(\"query\").attr('seconds'));\n      let lastActivityTime = $(iq).find(\"query\").attr('seconds');\n      setLastActivity(lastActivityTime);\n    });\n    return true;\n  };\n\n  useEffect(() => {\n    connection.addHandler(onLastActivity, null, \"presence\", null, null, null);\n  }, [showMainPage]);\n  return React.createElement(React.Fragment, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 67\n    },\n    __self: this\n  }, React.createElement(\"button\", {\n    onClick: getLastActivity,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 68\n    },\n    __self: this\n  }, \"last activity\"), React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 69\n    },\n    __self: this\n  }, lastActivity), React.createElement(\"div\", {\n    onClick: () => handleRosterClick(props.item.jid),\n    className: \"row item\",\n    id: props.item.jid,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 70\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"avatar\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 75\n    },\n    __self: this\n  }, React.createElement(RosterStatusDetector, {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 77\n    },\n    __self: this\n  }), React.createElement(\"img\", {\n    alt: \"avatar\",\n    src: avatarImage,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 78\n    },\n    __self: this\n  })), React.createElement(\"div\", {\n    className: \"right-side\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 80\n    },\n    __self: this\n  }, React.createElement(\"div\", {\n    className: \"extension\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 81\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 82\n    },\n    __self: this\n  }, \"112\")), React.createElement(\"div\", {\n    className: \"contact-name\",\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 85\n    },\n    __self: this\n  }, React.createElement(\"p\", {\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 86\n    },\n    __self: this\n  }, props.item.name)))));\n};\n\nexport default ContactItem;","map":{"version":3,"sources":["/home/paria/sandbox/projects/webfon-V2/webfonv2/src/components/contact-item/index.js"],"names":["React","useEffect","useState","avatarImage","useDispatch","useSelector","RosterStatusDetector","$","ContactItem","props","dispatch","connection","state","$iq","showMainPage","lastActivity","setLastActivity","handleRosterClick","contact","console","log","type","getLastActivity","iq","from","jid","to","item","id","c","xmlns","sendIQ","onLastActivity","attr","document","querySelectorAll","each","time","seconds","find","lastActivityTime","addHandler","name"],"mappings":"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","sourcesContent":["import React, {useEffect, useState} from \"react\";\nimport avatarImage from \"../../images/avatar.jpg\";\nimport \"./style.css\";\nimport {useDispatch, useSelector} from \"react-redux\";\nimport RosterStatusDetector from \"../roster-status-detector\";\nimport $ from \"jquery\";\n\nconst ContactItem = (props) => {\n    const dispatch = useDispatch();\n    const connection = useSelector(state => state.connection);\n    const $iq = useSelector(state => state.$iq);\n    const showMainPage = useSelector(state => state.showMainPage);\n    const [lastActivity, setLastActivity] = useState('')\n    const handleRosterClick = (contact) => {\n        console.log(contact);\n        dispatch({contact, type: \"SET_SELECTED_ROSTER\"});\n    };\n    const getLastActivity = () => {\n        let iq = $iq({\n            type: \"get\",\n            from: connection.jid,\n            to: props.item.jid,\n            id: \"last1\"\n        }).c(\"query\", {xmlns: \"jabber:iq:last\"})\n        connection.sendIQ(iq);\n    };\n    useEffect(() => {\n        getLastActivity()\n    }, [showMainPage]);\n    const onLastActivity = (iq) => {\n        let from = $(iq).attr(\"from\"); // the jabber_id of the contact\\+\n        let contact = document.querySelectorAll('.item');\n        console.log(\"from\", from);\n\n        $(iq).each(() => {\n            let lastActivity = {\n                from : from,\n                time : seconds\n            }\n\n            console.log(\"lastActivity\",\n                $(iq).find(\"query\")\n                    .attr('seconds')\n            );\n\n            let lastActivityTime = $(iq).find(\"query\").attr('seconds')\n            setLastActivity(lastActivityTime);\n\n\n        });\n\n        return true;\n\n    };\n    useEffect(() => {\n        connection.addHandler(\n            onLastActivity,\n            null,\n            \"presence\",\n            null,\n            null,\n            null\n        );\n\n    }, [showMainPage]);\n    return (\n        <React.Fragment>\n            <button onClick={getLastActivity}>last activity</button>\n            <p>{lastActivity}</p>\n            <div\n                onClick={() => handleRosterClick(props.item.jid)}\n                className=\"row item\"\n                id={props.item.jid}\n            >\n                <div className=\"avatar\">\n\n                    <RosterStatusDetector/>\n                    <img alt=\"avatar\" src={avatarImage}/>\n                </div>\n                <div className=\"right-side\">\n                    <div className=\"extension\">\n                        <p>112</p>\n                    </div>\n\n                    <div className=\"contact-name\">\n                        <p>{props.item.name}</p>\n                    </div>\n                </div>\n            </div>\n\n        </React.Fragment>\n    );\n\n};\n\n\nexport default ContactItem;\n"]},"metadata":{},"sourceType":"module"}